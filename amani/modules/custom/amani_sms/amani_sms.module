<?php 

/**
 * Implments hook_menu().
 */
function amani_sms_menu() {
  $items['sms'] = array(
    'page callback' => 'amani_sms_endpoint',
    'access callback' => TRUE,
  );

  return $items;
}

/**
 * Gets the messages(SMSs) sent by SMSsync as a POST request.
 *
 */
function amani_sms_endpoint() {
  $error = NULL;
  // Set success to false as the default success status
  $success = true;

  //if (isset($_POST['from'])) {
  //  $from = $_POST['from'];
  //}
  //else {
  //  $error = 'The from variable was not set';
  //}

  $response = '[' . json_encode(array(
    'payload' => array(
      'success' => $success,
      'error'   => $error
    )
  )) . ']';

  return drupal_json_output($response);
}

/**
 * Writes the received responses to a file. This acts as a database.
 */
function write_message_to_file($message) {
    $myFile = "test.txt";
    $fh = fopen($myFile, 'a') or die("can't open file");
    @fwrite($fh, $message);
    @fclose($fh);
}
